'use strict';

document.addEventListener('DOMContentLoaded', function (e) {
	var gameBoard = getSizedCanvas('game-board'),
	    universe = new Universe(gameBoard),
	    starfield = new Starfield(getSizedCanvas('background'), { universe: universe });

	document.addEventListener('fullscreenchange', onResize);
	document.addEventListener('mozfullscreenchange', onResize);
	document.addEventListener('webkitfullscreenchange', onResize);
	window.addEventListener('resize', onResize);
	function onResize(e) {
		setTimeout(function () {
			getSizedCanvas('background');
			getSizedCanvas('game-board');
			starfield.forceResize();
			universe.starSystem.forceRedraw();
		});
	}
	onResize();

	function getSizedCanvas(id) {
		var canvas = document.getElementById(id);
		canvas.width = canvas.clientWidth;
		canvas.height = canvas.clientHeight;
		console.log('Setting canvas ' + id + ' to ' + canvas.width + ' x ' + canvas.height);
		return canvas;
	}

	universe.on('state-change', function (state) {
		document.body.classList.remove('pregame');
		document.body.classList.remove('targetting');
		document.body.classList.remove('ongoing-shot');
		document.body.classList.remove('game-over');
		document.body.classList.remove('powering-up');
		switch (state) {
			case Universe.PREGAME:
				document.body.classList.add('pregame');
				break;
			case Universe.TARGETTING:
				document.body.classList.add('targetting');
				break;
			case Universe.POWERING:
				document.body.classList.add('powering-up');
				break;
			case Universe.ONGOING_SHOT:
				document.body.classList.add('ongoing-shot');
				break;
			case Universe.GAME_OVER:
				document.body.classList.add('game-over');
				break;
		}
	});
	universe.on('change-player', function (player) {
		document.body.classList.remove('player-1');
		document.body.classList.remove('player-2');
		document.body.classList.add('player-' + (player + 1));
	});

	document.addEventListener('click', function (e) {
		if (universe.gameState.state == Universe.PREGAME) universe.startGame();
	});
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL21haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2FtZUJvYXJkIiwiZ2V0U2l6ZWRDYW52YXMiLCJ1bml2ZXJzZSIsIlVuaXZlcnNlIiwic3RhcmZpZWxkIiwiU3RhcmZpZWxkIiwib25SZXNpemUiLCJ3aW5kb3ciLCJlIiwic2V0VGltZW91dCIsImZvcmNlUmVzaXplIiwic3RhclN5c3RlbSIsImZvcmNlUmVkcmF3IiwiaWQiLCJjYW52YXMiLCJnZXRFbGVtZW50QnlJZCIsIndpZHRoIiwiY2xpZW50V2lkdGgiLCJoZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJjb25zb2xlIiwibG9nIiwib24iLCJib2R5IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic3RhdGUiLCJQUkVHQU1FIiwiYWRkIiwiVEFSR0VUVElORyIsIlBPV0VSSU5HIiwiT05HT0lOR19TSE9UIiwiR0FNRV9PVkVSIiwicGxheWVyIiwiZ2FtZVN0YXRlIiwic3RhcnRHYW1lIl0sIm1hcHBpbmdzIjoiOztBQUFBQSxTQUFTQyxnQkFBVCxDQUEwQixrQkFBMUIsRUFBOEMsYUFBSztBQUNsRCxLQUFNQyxZQUFZQyxlQUFlLFlBQWYsQ0FBbEI7QUFBQSxLQUNDQyxXQUFXLElBQUlDLFFBQUosQ0FBYUgsU0FBYixDQURaO0FBQUEsS0FFQ0ksWUFBWSxJQUFJQyxTQUFKLENBQ1hKLGVBQWUsWUFBZixDQURXLEVBRVgsRUFBRUMsa0JBQUYsRUFGVyxDQUZiOztBQU1BSixVQUFTQyxnQkFBVCxDQUEwQixrQkFBMUIsRUFBOENPLFFBQTlDO0FBQ0FSLFVBQVNDLGdCQUFULENBQTBCLHFCQUExQixFQUFpRE8sUUFBakQ7QUFDQVIsVUFBU0MsZ0JBQVQsQ0FBMEIsd0JBQTFCLEVBQW9ETyxRQUFwRDtBQUNBQyxRQUFPUixnQkFBUCxDQUF3QixRQUF4QixFQUFrQ08sUUFBbEM7QUFDQSxVQUFTQSxRQUFULENBQWtCRSxDQUFsQixFQUFxQjtBQUNwQkMsYUFBVyxZQUFNO0FBQ2hCUixrQkFBZSxZQUFmO0FBQ0FBLGtCQUFlLFlBQWY7QUFDQUcsYUFBVU0sV0FBVjtBQUNBUixZQUFTUyxVQUFULENBQW9CQyxXQUFwQjtBQUNBLEdBTEQ7QUFNQTtBQUNETjs7QUFFQSxVQUFTTCxjQUFULENBQXdCWSxFQUF4QixFQUE0QjtBQUMzQixNQUFNQyxTQUFTaEIsU0FBU2lCLGNBQVQsQ0FBd0JGLEVBQXhCLENBQWY7QUFDQUMsU0FBT0UsS0FBUCxHQUFlRixPQUFPRyxXQUF0QjtBQUNBSCxTQUFPSSxNQUFQLEdBQWdCSixPQUFPSyxZQUF2QjtBQUNBQyxVQUFRQyxHQUFSLENBQVksb0JBQW9CUixFQUFwQixHQUF5QixNQUF6QixHQUNYQyxPQUFPRSxLQURJLEdBQ0ksS0FESixHQUNZRixPQUFPSSxNQUQvQjtBQUVBLFNBQU9KLE1BQVA7QUFDQTs7QUFFRFosVUFBU29CLEVBQVQsQ0FBWSxjQUFaLEVBQTRCLGlCQUFTO0FBQ3BDeEIsV0FBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkMsTUFBeEIsQ0FBK0IsU0FBL0I7QUFDQTNCLFdBQVN5QixJQUFULENBQWNDLFNBQWQsQ0FBd0JDLE1BQXhCLENBQStCLFlBQS9CO0FBQ0EzQixXQUFTeUIsSUFBVCxDQUFjQyxTQUFkLENBQXdCQyxNQUF4QixDQUErQixjQUEvQjtBQUNBM0IsV0FBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkMsTUFBeEIsQ0FBK0IsV0FBL0I7QUFDQTNCLFdBQVN5QixJQUFULENBQWNDLFNBQWQsQ0FBd0JDLE1BQXhCLENBQStCLGFBQS9CO0FBQ0EsVUFBUUMsS0FBUjtBQUNDLFFBQUt2QixTQUFTd0IsT0FBZDtBQUNDN0IsYUFBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkksR0FBeEIsQ0FBNEIsU0FBNUI7QUFDQTtBQUNELFFBQUt6QixTQUFTMEIsVUFBZDtBQUNDL0IsYUFBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkksR0FBeEIsQ0FBNEIsWUFBNUI7QUFDQTtBQUNELFFBQUt6QixTQUFTMkIsUUFBZDtBQUNDaEMsYUFBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkksR0FBeEIsQ0FBNEIsYUFBNUI7QUFDQTtBQUNELFFBQUt6QixTQUFTNEIsWUFBZDtBQUNDakMsYUFBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkksR0FBeEIsQ0FBNEIsY0FBNUI7QUFDQTtBQUNELFFBQUt6QixTQUFTNkIsU0FBZDtBQUNDbEMsYUFBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkksR0FBeEIsQ0FBNEIsV0FBNUI7QUFDQTtBQWZGO0FBaUJBLEVBdkJEO0FBd0JBMUIsVUFBU29CLEVBQVQsQ0FBWSxlQUFaLEVBQTZCLGtCQUFVO0FBQ3RDeEIsV0FBU3lCLElBQVQsQ0FBY0MsU0FBZCxDQUF3QkMsTUFBeEIsQ0FBK0IsVUFBL0I7QUFDQTNCLFdBQVN5QixJQUFULENBQWNDLFNBQWQsQ0FBd0JDLE1BQXhCLENBQStCLFVBQS9CO0FBQ0EzQixXQUFTeUIsSUFBVCxDQUFjQyxTQUFkLENBQXdCSSxHQUF4QixjQUFzQ0ssU0FBUyxDQUEvQztBQUNBLEVBSkQ7O0FBTUFuQyxVQUFTQyxnQkFBVCxDQUEwQixPQUExQixFQUFtQyxhQUFLO0FBQ3ZDLE1BQUlHLFNBQVNnQyxTQUFULENBQW1CUixLQUFuQixJQUE0QnZCLFNBQVN3QixPQUF6QyxFQUNDekIsU0FBU2lDLFNBQVQ7QUFDRCxFQUhEO0FBS0EsQ0FqRUQiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBlID0+IHtcblx0Y29uc3QgZ2FtZUJvYXJkID0gZ2V0U2l6ZWRDYW52YXMoJ2dhbWUtYm9hcmQnKSxcblx0XHR1bml2ZXJzZSA9IG5ldyBVbml2ZXJzZShnYW1lQm9hcmQpLFxuXHRcdHN0YXJmaWVsZCA9IG5ldyBTdGFyZmllbGQoXG5cdFx0XHRnZXRTaXplZENhbnZhcygnYmFja2dyb3VuZCcpLFxuXHRcdFx0eyB1bml2ZXJzZSB9KTtcblxuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdmdWxsc2NyZWVuY2hhbmdlJywgb25SZXNpemUpO1xuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3pmdWxsc2NyZWVuY2hhbmdlJywgb25SZXNpemUpO1xuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3ZWJraXRmdWxsc2NyZWVuY2hhbmdlJywgb25SZXNpemUpO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgb25SZXNpemUpO1xuXHRmdW5jdGlvbiBvblJlc2l6ZShlKSB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRnZXRTaXplZENhbnZhcygnYmFja2dyb3VuZCcpO1xuXHRcdFx0Z2V0U2l6ZWRDYW52YXMoJ2dhbWUtYm9hcmQnKTtcblx0XHRcdHN0YXJmaWVsZC5mb3JjZVJlc2l6ZSgpO1xuXHRcdFx0dW5pdmVyc2Uuc3RhclN5c3RlbS5mb3JjZVJlZHJhdygpO1xuXHRcdH0pO1xuXHR9XG5cdG9uUmVzaXplKCk7XG5cblx0ZnVuY3Rpb24gZ2V0U2l6ZWRDYW52YXMoaWQpIHtcblx0XHRjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG5cdFx0Y2FudmFzLndpZHRoID0gY2FudmFzLmNsaWVudFdpZHRoO1xuXHRcdGNhbnZhcy5oZWlnaHQgPSBjYW52YXMuY2xpZW50SGVpZ2h0O1xuXHRcdGNvbnNvbGUubG9nKCdTZXR0aW5nIGNhbnZhcyAnICsgaWQgKyAnIHRvICcgK1xuXHRcdFx0Y2FudmFzLndpZHRoICsgJyB4ICcgKyBjYW52YXMuaGVpZ2h0KTtcblx0XHRyZXR1cm4gY2FudmFzO1xuXHR9XG5cblx0dW5pdmVyc2Uub24oJ3N0YXRlLWNoYW5nZScsIHN0YXRlID0+IHtcblx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3ByZWdhbWUnKTtcblx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3RhcmdldHRpbmcnKTtcblx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ29uZ29pbmctc2hvdCcpO1xuXHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnZ2FtZS1vdmVyJyk7XG5cdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdwb3dlcmluZy11cCcpO1xuXHRcdHN3aXRjaCAoc3RhdGUpIHtcblx0XHRcdGNhc2UgVW5pdmVyc2UuUFJFR0FNRTpcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdwcmVnYW1lJyk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBVbml2ZXJzZS5UQVJHRVRUSU5HOlxuXHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3RhcmdldHRpbmcnKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFVuaXZlcnNlLlBPV0VSSU5HOlxuXHRcdFx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3Bvd2VyaW5nLXVwJyk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBVbml2ZXJzZS5PTkdPSU5HX1NIT1Q6XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnb25nb2luZy1zaG90Jyk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBVbml2ZXJzZS5HQU1FX09WRVI6XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnZ2FtZS1vdmVyJyk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSk7XG5cdHVuaXZlcnNlLm9uKCdjaGFuZ2UtcGxheWVyJywgcGxheWVyID0+IHtcblx0XHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXllci0xJyk7XG5cdFx0ZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5ZXItMicpO1xuXHRcdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChgcGxheWVyLSR7cGxheWVyICsgMX1gKTtcblx0fSk7XG5cdFxuXHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdGlmICh1bml2ZXJzZS5nYW1lU3RhdGUuc3RhdGUgPT0gVW5pdmVyc2UuUFJFR0FNRSlcblx0XHRcdHVuaXZlcnNlLnN0YXJ0R2FtZSgpO1xuXHR9KTtcblxufSk7Il19